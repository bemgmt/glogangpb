<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>iOS Safari Test - GLO GANG Photobooth</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  
  <!-- iOS Safari Compatibility Fixes -->
  <link rel="stylesheet" href="css/ios-fixes.css">
  
  <style>
    :root{
      --bg:#0f1115; --panel:#171a21; --muted:#8b93a7; --text:#f6f7fb;
      --accent:#ffd100; --ink:#121212; --ok:#2ecc71; --warn:#ff5a5f;
      --ring:rgba(255,209,0,.35); --stroke:rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font-family: ui-rounded, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      -webkit-font-smoothing:antialiased;
      padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
    }

    .test-container {
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .test-section {
      background: var(--panel);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .test-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }

    .test-card {
      background: var(--panel);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 12px;
      padding: 16px;
      min-height: 200px;
    }

    .test-thumbs {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
      gap: 10px;
      margin: 10px 0;
      min-height: 100px;
      background: rgba(255,0,0,0.1);
      border: 2px dashed red;
      padding: 10px;
    }

    .test-thumb {
      background: #0f1320;
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 12px;
      padding: 6px;
      display: grid;
      place-items: center;
      height: 90px;
      color: white;
      font-size: 12px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      background: #1e212a;
      color: var(--text);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 14px;
      padding: 12px 16px;
      font-weight: 800;
      text-decoration: none;
      cursor: pointer;
      margin: 5px;
    }

    .btn:hover {
      background: #2a2d36;
    }

    .debug-info {
      background: #000;
      color: #0f0;
      font-family: monospace;
      font-size: 12px;
      padding: 10px;
      border-radius: 5px;
      margin: 10px 0;
      white-space: pre-wrap;
      max-height: 300px;
      overflow: auto;
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
    }

    .status-ok { background: #2ecc71; }
    .status-warn { background: #ff5a5f; }
    .status-info { background: #3498db; }

    @media (max-width: 768px) {
      .test-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h1>üîç iOS Safari Compatibility Test</h1>
    <p>This page tests the same layout structure as the photobooth to diagnose iOS Safari issues.</p>

    <div class="test-section">
      <h2>Device Information</h2>
      <div id="device-info" class="debug-info">Loading device information...</div>
      
      <button class="btn" onclick="runDiagnostics()">üîç Run Diagnostics</button>
      <button class="btn" onclick="enableDebugMode()">üêõ Enable Debug Mode</button>
      <button class="btn" onclick="testContainers()">üì¶ Test Containers</button>
      <button class="btn" onclick="window.location.href='photobooth.html'">üé• Go to Photobooth</button>
    </div>

    <div class="test-section">
      <h2>Layout Test (Same as Photobooth)</h2>
      <div class="test-grid">
        <!-- Overlays Test -->
        <div class="test-card">
          <h3><span class="status-indicator status-info"></span>Overlays Container</h3>
          <p>This should contain thumbnail buttons:</p>
          <div class="test-thumbs" id="test-overlays">
            <div class="test-thumb">Overlay 1</div>
            <div class="test-thumb">Overlay 2</div>
            <div class="test-thumb">Overlay 3</div>
          </div>
        </div>

        <!-- Props Test -->
        <div class="test-card">
          <h3><span class="status-indicator status-info"></span>Props Container</h3>
          <p>This should contain thumbnail buttons:</p>
          <div class="test-thumbs" id="test-props">
            <div class="test-thumb">Prop 1</div>
            <div class="test-thumb">Prop 2</div>
            <div class="test-thumb">Prop 3</div>
          </div>
        </div>
      </div>
    </div>

    <div class="test-section">
      <h2>CSS Support Test</h2>
      <div id="css-support" class="debug-info">Testing CSS support...</div>
    </div>

    <div class="test-section">
      <h2>Container Visibility Test</h2>
      <div id="visibility-test" class="debug-info">Testing container visibility...</div>
    </div>

    <div class="test-section">
      <h2>Diagnostics Results</h2>
      <div id="diagnostics-results" class="debug-info">Click "Run Diagnostics" to see results...</div>
    </div>
  </div>

  <!-- iOS Safari Diagnostics and Fixes -->
  <script src="js/ios-diagnostics.js"></script>
  
  <script>
    // Test functions
    function updateDeviceInfo() {
      const info = {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        viewport: `${window.innerWidth}x${window.innerHeight}`,
        screen: `${screen.width}x${screen.height}`,
        devicePixelRatio: window.devicePixelRatio,
        isIOS: /iPad|iPhone|iPod/.test(navigator.userAgent) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1),
        isSafari: /^((?!chrome|android).)*safari/i.test(navigator.userAgent)
      };
      
      document.getElementById('device-info').textContent = JSON.stringify(info, null, 2);
    }

    function testCSSSupport() {
      const tests = {
        'CSS Grid': CSS.supports('display', 'grid'),
        'CSS Flexbox': CSS.supports('display', 'flex'),
        'CSS Variables': CSS.supports('color', 'var(--test)'),
        'CSS Inset': CSS.supports('inset', '0'),
        'CSS aspect-ratio': CSS.supports('aspect-ratio', '1/1'),
        'CSS place-items': CSS.supports('place-items', 'center')
      };
      
      let result = 'CSS Support Test Results:\n';
      for (const [test, supported] of Object.entries(tests)) {
        result += `${supported ? '‚úÖ' : '‚ùå'} ${test}: ${supported ? 'Supported' : 'Not Supported'}\n`;
      }
      
      document.getElementById('css-support').textContent = result;
    }

    function testContainers() {
      const containers = [
        { name: 'Test Overlays', element: document.getElementById('test-overlays') },
        { name: 'Test Props', element: document.getElementById('test-props') },
        { name: 'Test Grid', element: document.querySelector('.test-grid') }
      ];
      
      let result = 'Container Visibility Test:\n';
      
      containers.forEach(({ name, element }) => {
        if (element) {
          const rect = element.getBoundingClientRect();
          const styles = window.getComputedStyle(element);
          const isVisible = rect.width > 0 && rect.height > 0 && 
                           styles.visibility !== 'hidden' && 
                           styles.display !== 'none';
          
          result += `${isVisible ? '‚úÖ' : '‚ùå'} ${name}:\n`;
          result += `  Dimensions: ${rect.width}x${rect.height}\n`;
          result += `  Position: ${rect.left},${rect.top}\n`;
          result += `  Display: ${styles.display}\n`;
          result += `  Visibility: ${styles.visibility}\n`;
          result += `  Opacity: ${styles.opacity}\n\n`;
        } else {
          result += `‚ùå ${name}: Element not found\n\n`;
        }
      });
      
      document.getElementById('visibility-test').textContent = result;
    }

    function runDiagnostics() {
      if (window.IOSDiagnostics) {
        const report = window.IOSDiagnostics.runDiagnostics();
        document.getElementById('diagnostics-results').textContent = JSON.stringify(report, null, 2);
      } else {
        document.getElementById('diagnostics-results').textContent = 'IOSDiagnostics not loaded';
      }
    }

    function enableDebugMode() {
      if (window.IOSDiagnostics) {
        window.IOSDiagnostics.enableDebugMode();
      }
      document.body.classList.add('debug');
    }

    // Initialize tests
    document.addEventListener('DOMContentLoaded', () => {
      updateDeviceInfo();
      testCSSSupport();
      testContainers();
      
      // Update on resize/orientation change
      window.addEventListener('resize', () => {
        setTimeout(() => {
          updateDeviceInfo();
          testContainers();
        }, 100);
      });
      
      window.addEventListener('orientationchange', () => {
        setTimeout(() => {
          updateDeviceInfo();
          testContainers();
        }, 500);
      });
    });
  </script>
</body>
</html>
